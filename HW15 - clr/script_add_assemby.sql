  
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;
 
USE WideWorldImporters 
GO

PRINT N'Creating [RegularExpressions]...'; 
GO

CREATE ASSEMBLY [RegularExpressions]
    AUTHORIZATION [dbo]
    FROM 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C01030026C4425F0000000000000000E00022200B013000001A000000060000000000002E380000002000000040000000000010002000000002000004000000000000000600000000000000008000000002000000000000030060850000100000100000000010000010000000000000100000000000000000000000DC3700004F00000000400000D002000000000000000000000000000000000000006000000C000000A43600001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E746578740000003418000000200000001A000000020000000000000000000000000000200000602E72737263000000D00200000040000000040000001C0000000000000000000000000000400000402E72656C6F6300000C000000006000000002000000200000000000000000000000000000400000420000000000000000000000000000000010380000000000004800000002000500502600005410000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B3003007B0000000100001100000F00280D00000A2D150F01280D00000A2D0C0F02280D00000A16FE012B01160A062C42000F00280E00000A0F01280E00000A280F00000A0B072C220F00280E00000A0F01280E00000A0F02280E00000A281000000A281100000A0CDE1A7E1200000A0CDE127E1200000A0CDE0A26007E1200000A0CDE00082A0001100000000001006E6F000A050000011B300200390000000200001100000F01280E00000A7E01000004731300000A0A06026F1400000A731500000A6F1600000A281700000A0BDE0A26007E1800000A0BDE00072A00000001100000000001002C2D000A050000011B300200650000000300001100000F01280E00000A7E01000004731300000A0A06026F1400000A731500000A6F1900000A0B076F1A00000A2D07281B00000A2B21076F1C00000A0F02280E00000A6F1D00000A6F1E00000A281100000A731F00000A0CDE0A2600281B00000A0CDE00082A00000001100000000001005859000A05000001133002001D0000000400001100026F1400000A731500000A0F01280E00000A730C0000060A2B00062A000000133002002C00000005000011000274030000020A03066F09000006732000000A810E00000104066F0A0000066F2100000A732200000A512A133002001D0000000400001100026F1400000A731500000A0F01280E00000A73120000060A2B00062A000000133002003E00000006000011000274050000020A03066F0E000006732000000A810E00000104066F0F0000066F2100000A732200000A5105066F100000066F2100000A732200000A512A221F3080010000042A00133001000C0000000700001100027B020000040A2B00062A133001000C0000000800001100027B030000040A2B00062A5E02282300000A000002037D0200000402047D030000042A8602282300000A000002047E01000004731300000A7D0400000402037D050000042A3A16731400000625027D0D0000042A000000133001000C0000000700001100027B060000040A2B00062A133001000C0000000800001100027B070000040A2B00062A133001000C0000000800001100027B080000040A2B00062A7A02282300000A000002037D0600000402047D0700000402057D080000042A8602282300000A000002047E01000004731300000A7D0900000402037D0A0000042A3A16731A00000625027D120000042A3E02282300000A0002037D0B0000042A062A000013300300C500000009000011027B0B0000040A062C082B0006172E042B072B07388F000000162A02157D0B0000040002167D0E00000402147D0F0000040002027B0F0000042C0D027B0F0000046F2400000A2B1B027B0D0000047B04000004027B0D0000047B050000046F1900000A7D0F000004027B0F0000046F1A00000A0B072C390002027B0E00000417580C02087D0E00000408027B0F0000046F1E00000A730B0000067D0C00000402177D0B000004172A02157D0B0000040000027B0F0000046F1A00000A0D093A6EFFFFFF162A1E027B0C0000042A1A732500000A7A3E02282300000A0002037D100000042A133004007C0100000A000011027B100000040A062C082B0006172E042B072B07380C010000162A02157D100000040002167D1300000402147D1400000402027B120000047B090000046F2600000A7D1500000400027B130000040B020717587D1300000402027B140000042C0D027B140000046F2400000A2B1B027B120000047B09000004027B120000047B0A0000046F1900000A7D14000004027B140000046F1A00000A0C0839C5000000000002027B150000047D1600000402167D17000004389000000002027B16000004027B170000049A7D180000040002027B140000046F1C00000A027B180000046F1D00000A7D19000004027B190000046F1A00000A0D092C340002027B13000004027B18000004027B190000046F1E00000A73110000067D1100000402177D10000004172A02157D10000004000002147D1900000402147D1800000402027B1700000417587D17000004027B17000004027B160000048E693F5DFFFFFF02147D160000040000027B140000046F1A00000A130411043ACDFEFFFF162A1E027B110000042A42534A4201000100000000000C00000076342E302E33303331390000000005006C00000024070000237E0000900700009405000023537472696E677300000000240D00000400000023555300280D0000100000002347554944000000380D00001C03000023426C6F6200000000000000020000015717A20B0902000000FA013300160000010000001A00000008000000190000001F0000001E0000000800000026000000160000000A0000000400000009000000090000000A00000001000000010000000300000002000000000034020100000000000600A5014A030600C5014A030600460137030F006A03000006001E0468020A00E503B3030E009001D9020E00F40194030E006F0294030E00090494030A007805B3030A002E02B3030600D100D2030E001B0094030600F800680206005A014A030600F402D20306002B014A030600DD00680206000D009A000600780137030A00CD02B3030600030268020A007A02B3030A00FD00B30306008A0268020000000077000000000001000100810110007505BF0315000100010000001000BD00BF03150002000900000010000E03BF03150004000C0000001000C700BF03150006000E00000010001C03BF03150009001200030110003E00000015000B001400030110003E000000150010001A003600EA03D10001006E05D5000100ED01D80001007E05DB0001003505D80001006E05D5000100F200D8000100ED01D80001007E05DB0001003505D80001002001D50001002805DF000600A903E20001000100D50001002400E60001002001D50001002805DF000600A903EA0001000100D50001002400E60001003200EE0001005200EE0001005900D50001006000D80001006B00F20050200000000096000A02F6000100E8200000000096002902010104004021000000009600C8020A010600C421000000009600790315010900F0210000000096004A051E010B002822000000009600FD0315010E0054220000000096005705290110009E22000000009118300337011400A82200000000860864053B011400C022000000008608E30130001400D8220000000086182A033F011400F0220000000086182A0345011600122300000000E60100034B011800242300000000860864053B0118003C23000000008608E900300018005423000000008608E301300018006C230000000086182A03500118008B230000000086182A0345011B00AD2300000000E60100034B011D00BC230000000086182A0301001D00CC2300000000E101050106001E00D02300000000E1013C0516001E00A12400000000E109BB0425001E00A92400000000E101250406001E00A12400000000E109FD0425001E00B0240000000086182A0301001E00CC2300000000E101050106001F00C02400000000E1013C0516001F00482600000000E109BB0425001F00A92400000000E101250406001F00482600000000E109FD0425001F0000000100FE0100000200A00200000300AD0200000100360500000200C00200000100360500000200C00200000300F30000000100360500000200C002000001008C00020002006F0502000300450500000100360500000200C002000001008C00020002006F0502000300D302020004004505000001006F0500000200EE0100000100360500000200C002000001006F0500000200D30200000300EE0100000100360500000200C00200000100200100000100200104003500060035000700060007004D00070045000800060008004D000800450009002A03010011002A03060019002A030A0039002A03060081002A03100091002A03060099001801060089003C0516000C001C05200089004404060089001C052500A9002A0306004100540216004100E30130005900170234005900B5003A0041004A04410041005A02470059002A0352005100E3015900B9002A035E0059001702640049004A04690049005A026F0059002E027C00B1001204160051004B0282006100F2038700C1005F028C00C900E301300051002A03920071002A030100B9008505590051002A035E0029002A03060061001F02B600D1002A03060059008603C3002000230094012E000B0063012E0013006C012E001B008B0140002300C00160002300C00180002300D801C00023003102E30033001403030133001403A0012B00A00260022B00DA02800263001403A00263001403E00263001403000363001403200363001403400363001403600363001403A00363001403C00363001403E0036300140329004B00730098009D00A200A700AB00AF00BB00030001000500030007000600080008000000680557010000E7015B010000680557010000ED005B010000E7015B01000056045F01000094045F01000056045F01000094045F0102000900030002000A00050002000E00070002000F000900020010000B00020017000D00020019000F0002001D00110002001F00130007002A000F0007002C00110007002E001300070030001500070032001700080036000F0008003800110008003A00130008003C00150008003E0017001A00048000000000000000000000000000000000BF030000040000000000000000000000C800910000000000040000000000000000000000C800680200000000040000000000000000000000C80080000000000007000400080006000000003C696E6465783E355F5F310049456E756D657261746F7260310053716C496E743332003C63757272656E743E355F5F32003C6E616D65733E355F5F33003C476574456E756D657261746F723E645F5F33003C3E735F5F34003C3E735F5F35003C6E616D653E355F5F36003C67726F75703E355F5F37003C4D6F64756C653E0053797374656D2E446174610064617461006D73636F726C69620053797374656D2E436F6C6C656374696F6E732E47656E65726963005265706C616365004D617463684E6F64650047726F75704E6F64650049456E756D657261626C650049446973706F7361626C65006765745F4E616D65005F6E616D65005479706500436170747572650053797374656D2E49446973706F7361626C652E446973706F7365003C3E315F5F737461746500436F6D70696C657247656E6572617465644174747269627574650044656275676761626C65417474726962757465004974657261746F7253746174654D616368696E6541747472696275746500446562756767657248696464656E4174747269627574650053716C46756E6374696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E734174747269627574650052756E74696D65436F6D7061746962696C697479417474726962757465006765745F56616C7565005F76616C75650053716C537472696E6700496E707574537472696E67005265706C6163654D617463680049734D61746368004E6578744D617463680052656765784D6174636800526567756C617245787072657373696F6E732E646C6C006765745F4E756C6C006765745F49734E756C6C006765745F4974656D0053797374656D0053716C426F6F6C65616E0047726F7570436F6C6C656374696F6E004E6F74537570706F72746564457863657074696F6E004D617463685061747465726E005265706C6163656D656E745061747465726E007061747465726E00526567657847726F75700067726F7570004D6963726F736F66742E53716C5365727665722E5365727665720049456E756D657261746F7200476574456E756D657261746F72004D617463684974657261746F720047726F75704974657261746F72002E63746F72002E6363746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730052656765784D6174636865730047657447726F75704E616D65730053797374656D2E446174612E53716C5479706573003C3E345F5F746869730053797374656D2E546578742E526567756C617245787072657373696F6E730053797374656D2E436F6C6C656374696F6E730052656765784F7074696F6E73006765745F47726F75707300526567657847726F7570730053716C4368617273006765745F53756363657373004F626A6563740053797374656D2E436F6C6C656374696F6E732E49456E756D657261746F722E5265736574006F705F496D706C696369740053797374656D2E436F6C6C656374696F6E732E47656E657269632E49456E756D657261746F723C53797374656D2E4F626A6563743E2E43757272656E740053797374656D2E436F6C6C656374696F6E732E49456E756D657261746F722E43757272656E740053797374656D2E436F6C6C656374696F6E732E47656E657269632E49456E756D657261746F723C53797374656D2E4F626A6563743E2E6765745F43757272656E740053797374656D2E436F6C6C656374696F6E732E49456E756D657261746F722E6765745F43757272656E74003C3E325F5F63757272656E74005F696E707574004D6F76654E65787400746578740046696C6C4D61746368526F770046696C6C47726F7570526F77006765745F496E646578005F696E6465780053716C5265676578005F726567657800546F436861724172726179000000000000000018669DE764F991468BEE42C4226D995D0004200101080320000105200101111105200101123D0320000205151251011C04200013000320001C060703020211210320000E050002020E0E0600030E0E0E0E05000111210E03061121060702122D1125062002010E11190420001D03052001011D03042001020E05000111250203061125080703122D1231122905200112310E0400001229042000126105200112590E0520010111210407011235040701120C0407011214030701080307010E06070408020802042000123107070508080202020420001D0E08B77A5C561934E0890306111902060802060E0306122D02061C03061210030612310306121803061D0E030612590A000311211121112111210800021125122911210A000312291229112111210800021235122911210A0003011C1011391012290D0004011C101139101229101229030000010320000805200201080E052002010E0E042000124506200301080E0E032800080328000E0328001C0801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000701000000002B01000200540E044E616D650C5265706C6163654D6174636854020F497344657465726D696E697374696301170100010054020F497344657465726D696E6973746963015801000200540E1146696C6C526F774D6574686F644E616D650C46696C6C4D61746368526F77540E0F5461626C65446566696E6974696F6E205B496E6465785D20696E742C5B546578745D206E76617263686172286D6178296E01000200540E1146696C6C526F774D6574686F644E616D650C46696C6C47726F7570526F77540E0F5461626C65446566696E6974696F6E365B496E6465785D20696E742C5B47726F75705D206E76617263686172286D6178292C5B546578745D206E76617263686172286D61782939010034526567756C617245787072657373696F6E732E4D617463684974657261746F722B3C476574456E756D657261746F723E645F5F33000039010034526567756C617245787072657373696F6E732E47726F75704974657261746F722B3C476574456E756D657261746F723E645F5F33000004010000000000000000000026C4425F00000000020000001C010000C0360000C018000052534453784B4B25B8B8374A8CD540E8FD74B62901000000443A5C576F726B696E675C4769745265706F7369746F72795C4F7475735C6F7475732D6D7373716C2D323032302D30362D706F6C796174796B696E615C48573133202D2073702C66756E635C43535C526567756C617245787072657373696F6E735C526567756C617245787072657373696F6E735C6F626A5C44656275675C526567756C617245787072657373696F6E732E7064620000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000438000000000000000000001E38000000200000000000000000000000000000000000000000000010380000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF25002000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100000001800008000000000000000000000000000000100010000003000008000000000000000000000000000000100000000004800000058400000740200000000000000000000740234000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000000000000000000000000000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004D4010000010053007400720069006E006700460069006C00650049006E0066006F000000B001000001003000300030003000300034006200300000002C0002000100460069006C0065004400650073006300720069007000740069006F006E000000000020000000300008000100460069006C006500560065007200730069006F006E000000000030002E0030002E0030002E00300000004E001700010049006E007400650072006E0061006C004E0061006D006500000052006500670075006C0061007200450078007000720065007300730069006F006E0073002E0064006C006C00000000002800020001004C006500670061006C0043006F0070007900720069006700680074000000200000005600170001004F0072006900670069006E0061006C00460069006C0065006E0061006D006500000052006500670075006C0061007200450078007000720065007300730069006F006E0073002E0064006C006C0000000000340008000100500072006F006400750063007400560065007200730069006F006E00000030002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000030002E0030002E0030002E00300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000C000000303800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000;
GO

PRINT N'Creating [dbo].[RegexGroup]...'; 
GO

CREATE FUNCTION [dbo].[RegexGroup]
(@input NVARCHAR (MAX) NULL, @pattern NVARCHAR (MAX) NULL, @name NVARCHAR (MAX) NULL)
RETURNS NVARCHAR (MAX)
AS
 EXTERNAL NAME [RegularExpressions].[RegularExpressions.SqlRegex].[RegexGroup]


GO
PRINT N'Creating [dbo].[RegexMatch]...';


GO
CREATE FUNCTION [dbo].[RegexMatch]
(@input NVARCHAR (MAX) NULL, @pattern NVARCHAR (MAX) NULL)
RETURNS BIT
AS
 EXTERNAL NAME [RegularExpressions].[RegularExpressions.SqlRegex].[RegexMatch]


GO
PRINT N'Creating [dbo].[ReplaceMatch]...';


GO
CREATE FUNCTION [dbo].[ReplaceMatch]
(@InputString NVARCHAR (MAX) NULL, @MatchPattern NVARCHAR (MAX) NULL, @ReplacementPattern NVARCHAR (MAX) NULL)
RETURNS NVARCHAR (MAX)
AS
 EXTERNAL NAME [RegularExpressions].[RegularExpressions.SqlRegex].[ReplaceMatch]


GO
PRINT N'Creating [dbo].[RegexGroups]...';


GO
CREATE FUNCTION [dbo].[RegexGroups]
(@input NVARCHAR (MAX) NULL, @pattern NVARCHAR (MAX) NULL)
RETURNS 
     TABLE (
        [Index] INT            NULL,
        [Group] NVARCHAR (MAX) NULL,
        [Text]  NVARCHAR (MAX) NULL)
AS
 EXTERNAL NAME [RegularExpressions].[RegularExpressions.SqlRegex].[RegexGroups]


GO
PRINT N'Creating [dbo].[RegexMatches]...';


GO
CREATE FUNCTION [dbo].[RegexMatches]
(@input NVARCHAR (MAX) NULL, @pattern NVARCHAR (MAX) NULL)
RETURNS 
     TABLE (
        [Index] INT            NULL,
        [Text]  NVARCHAR (MAX) NULL)
AS
 EXTERNAL NAME [RegularExpressions].[RegularExpressions.SqlRegex].[RegexMatches]


GO  

PRINT N'Creating [StringExpressions]...'; 
GO

CREATE ASSEMBLY [StringExpressions]
    AUTHORIZATION [dbo]
    FROM 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C01030042D3425F0000000000000000E00022200B0130000016000000060000000000008E3400000020000000400000000000100020000000020000040000000000000006000000000000000080000000020000000000000300608500001000001000000000100000100000000000001000000000000000000000003C3400004F00000000400000C802000000000000000000000000000000000000006000000C000000043300001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E7465787400000094140000002000000016000000020000000000000000000000000000200000602E72737263000000C8020000004000000004000000180000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000001C0000000000000000000000000000400000420000000000000000000000000000000070340000000000004800000002000500B0240000540E00000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000133002001800000001000011000F00280E00000A036F0F00000A73060000060A2B00062A133002002B00000002000011000274030000020A03066F03000006731000000A810A00000104066F04000006731100000A81080000012A00133001000C0000000300001100027B010000040A2B00062A133001000C0000000400001100027B020000040A2B00062A5E02281200000A000002037D0100000402047D020000042A5E02281200000A000002047D0300000402037D040000042A3A16730F00000625027D0A0000042A7E000272010000707D0600000402167D0500000402731300000A7D070000042A0013300300970000000500001173150000060A06037D10000004000F02281400000A16FE010B072C0D020F02280E00000A7D060000040F03281500000A16FE010C082C0D020F03281600000A7D05000004067C10000004281400000A0D092C022B41027B050000042C19027B0700000406FE0616000006731700000A6F1800000A2B0116130411042C022B17027B07000004067C10000004280E00000A6F1900000A002A001B300300B80000000600001100037B07000004252D0426162B08281A00000A16FE020A06399A00000000037B06000004281B00000A16FE010B072C0C02037B060000047D0600000400037B070000046F1C00000A0C2B5173170000060D091202281D00000A7D1100000400027B050000042C19027B0700000409FE0618000006731700000A6F1800000A2B0116130411042C022B13027B07000004097B110000046F1900000A00001202281E00000A2DA6DE0F1202FE160400001B6F0700000A00DC002A01100000020049005EA7000F00000000133002004300000007000011007E1F00000A0A027B070000042C10027B070000046F1A00000A16FE022B01160B072C1400027B06000004027B07000004282000000A0A0006731100000A0C2B00082A001330050056000000080000110002731300000A7D070000040314FE010B072C022B3F036F2100000A252D0426142B15178D1B0000012516027B06000004A217282200000A0A062D03162B05068E16FE030C082C0D027B07000004066F2300000A002A6A0003027B06000004027B07000004282000000A6F2400000A002A2202281200000A002A3E02281200000A0002037D080000042A062A13300400D700000009000011027B080000040A062C082B0006172E042B072B073888000000162A02157D080000040002167D0B00000402027B0A0000047B04000004027B0A0000047B03000004176F2500000A7D0C0000040002027B0C0000047D0D00000402167D0E0000042B5C02027B0D000004027B0E0000049A7D0F0000040002027B0B00000417580B02077D0B00000407027B0F00000473050000067D0900000402177D08000004172A02157D080000040002147D0F00000402027B0E00000417587D0E000004027B0E000004027B0D0000048E69329402147D0D000004162A1E027B090000042A1A732600000A7A4A03027C10000004280E00000A282700000A2A3603027B11000004282700000A2A0042534A4201000100000000000C00000076342E302E33303331390000000005006C000000C0050000237E00002C060000C805000023537472696E677300000000F40B00000800000023555300FC0B00001000000023475549440000000C0C00004802000023426C6F6200000000000000020000015717A20B0902000000FA013300160000010000001E0000000800000011000000180000001200000005000000270000000E0000000900000002000000040000000400000005000000040000000100000002000000030000000000C30201000000000006003C029C0306005C029C030600BC0189030F00BC03000006004E04E4020A0027023C030600430105040A00B902CB030A002B04CB030A008300CB0306005B01E4020600D0019C030600570305040600A1019C0306004F01E40206006E00F30006000F0289030A0047043C030A00EE013C030A0093023C0306007C00F3000A00EB02CB0357006603000006001703CF0006002F03CF0006006200E4020600BC02E40206005400F30006001804E4020600FB02E40200000000C6000000000001000100810110009605F303150001000100000010002A01F303150001000300000010007103F30315000300060001201000A402F303150005000800030110009A000000150008000F00030110000100000015001000150003011000160000001500110017000100AC05EA0001008402A60001003404ED0001007405A60001008B02F10001002403A6000100E003F40001009001EA0001005D05FB000600E903FE0001004800EA0001008C0002010100AE0002010100B500EA000100BC00A60006008502060106008503A60050200000000096007A040A0101007420000000009600890513010300AC20000000008608A20587000600C4200000000086087A0234000600DC200000000086187F031E010600F4200000000086187F03240108000C2100000000E60163032B010A001B21000000008600860406000A003C210000000086007B0130010A00E0210000000086003D013A010D00B422000000008600860140010E00042300000000E6010E0145010E00662300000000E6019B014B010F0081230000000086187F03060010008A230000000086187F03010010009A2300000000E1016001060011009C2300000000E1017B05160011007F2400000000E109F00425001100872400000000E1015504060011007F2400000000E10932052500110081230000000086187F03060011008E2400000000830037005101110081230000000086187F0306001200A1240000000083002B005101120000000100850200000200350400000100E50002000200AD0502000300840500000100AD05000002008502000001007505000002003504000001008502000002002503000003008C0200000100110300000100870300000100940500000100900100000100B10500000100B10504001D00050051000600060006003D000600350009007F03010011007F03060019007F030A0031007F03060061007F03100071007F03060079007301060069007B0516000C005105200069007404060069005105250089007F03060099007F03290041007A02340049007A02380051007F03010041007F03420029007F03060014007F0306004100D9021600B100D9021600B1007A0216001C007F036400140040046A0014001301740014006A058700D90017018B0014006303900024005105200024007B051600D900BF05A600D900F602A900C100AE023400D9008004BA0014003401C300C9009B014200D9008004D200F1007F030600D900B305DB002000230093012E000B0062012E0013006B012E001B008A01A3006B002A02C30033002502E0002B00EC01E30033002502030133002502E001630025020002630025024002630025026002630025028002630025022F003D0047004B0055007A009F00B300CD0003000100060003000000A605560100007E025A0100008B045E010000C9045E01020003000300020004000500020012000700020014000900060020000F000600220011000600240013000600260015000600280017001A004F005E009900048000000000000000000000000000000000F3030000040000000000000000000000E100EA0000000000040000000000000000000000E100D9000000000006000400070005000800050000000000003C3E635F5F446973706C6179436C617373345F30003C3E635F5F446973706C6179436C617373355F30003C4D657267653E625F5F30003C416363756D756C6174653E625F5F30003C696E6465783E355F5F310049456E756D657261626C6560310050726564696361746560310049456E756D657261746F726031004C69737460310053716C496E743332003C726573756C74733E355F5F32003C476574456E756D657261746F723E645F5F33003C3E735F5F33003C3E735F5F34003C7374723E355F5F35003C4D6F64756C653E0053797374656D2E494F0053797374656D2E446174610064617461006D73636F726C69620053797374656D2E436F6C6C656374696F6E732E47656E657269630052656164004164640049734E756C6C4F72576869746553706163650053706C69744E6F64650041646452616E6765004D657267650049456E756D657261626C650049446973706F7361626C6500547970650053797374656D2E49446973706F7361626C652E446973706F736500416363756D756C617465005465726D696E617465003C3E315F5F737461746500577269746500436F6D70696C657247656E6572617465644174747269627574650044656275676761626C65417474726962757465004974657261746F7253746174654D616368696E654174747269627574650053716C55736572446566696E656441676772656761746541747472696275746500446562756767657248696464656E4174747269627574650053716C46756E6374696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E734174747269627574650052756E74696D65436F6D7061746962696C697479417474726962757465006765745F56616C7565005F76616C7565005F756E69717565004942696E61727953657269616C697A6500537472696E674167670052656164537472696E670053716C537472696E6700537472696E6745787072657373696F6E732E646C6C006765745F49734E756C6C0053797374656D0053716C426F6F6C65616E004A6F696E004E6F74537570706F72746564457863657074696F6E0067726F75700042696E617279526561646572005F64656C696D657465720042696E617279577269746572004D6963726F736F66742E53716C5365727665722E5365727665720049456E756D657261746F7200476574456E756D657261746F720053706C69744974657261746F72002E63746F72007374720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730053797374656D2E446174612E53716C5479706573005F737472696E6773003C3E345F5F7468697300537472696E6745787072657373696F6E730053797374656D2E436F6C6C656374696F6E7300537472696E6753706C69744F7074696F6E730053716C4368617273005F64656C696D65746572730045786973747300466F726D6174004F626A6563740053797374656D2E436F6C6C656374696F6E732E49456E756D657261746F722E526573657400537472696E6753706C697400496E69740053797374656D2E436F6C6C656374696F6E732E47656E657269632E49456E756D657261746F723C53797374656D2E4F626A6563743E2E43757272656E740053797374656D2E436F6C6C656374696F6E732E49456E756D657261746F722E43757272656E740053797374656D2E436F6C6C656374696F6E732E47656E657269632E49456E756D657261746F723C53797374656D2E4F626A6563743E2E6765745F43757272656E740053797374656D2E436F6C6C656374696F6E732E49456E756D657261746F722E6765745F43757272656E74003C3E325F5F63757272656E74006765745F436F756E74005F696E707574004D6F76654E65787400746578740046696C6C53706C6974526F770053716C537472696E674578006765745F496E646578005F696E646578006F705F457175616C69747900456D7074790000000000033B0000000000B7880F7E4C87AC49939CAEA6C599C6FA0004200101080320000105200101111105200101122D0320000205151241011C04200013000320001C052001011149040701121D0320000E0420001D03040701120C042001010E030701080307010E05151255010E080705121C0202020205151269010E052002011C18092001021512690113000520010113000C0705020215115D010E12200203200008040001020E08200015115D0113000515115D010E0607030E02112102060E0900020E0E151271010E0607031D0E02020820021D0E1D0E11750920010115127101130004070208080820021D0E1D031175050002020E0E08B77A5C561934E08902060803061D030206020606151255010E02061C0306121003061D0E03061121080002121D112112250A0003011C10112910112105200201080E062002010E1D030420001235092003011121112111590520010112140420001121052001011261052001011265042001020E032800080328000E0328001C0801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000701000000005801000200540E1146696C6C526F774D6574686F644E616D650C46696C6C53706C6974526F77540E0F5461626C65446566696E6974696F6E205B496E6465785D20696E742C5B546578745D206E76617263686172286D61782938010033537472696E6745787072657373696F6E732E53706C69744974657261746F722B3C476574456E756D657261746F723E645F5F33000004010000001A010002000000010054080B4D61784279746553697A65401F00000000000000000042D3425F00000000020000001C01000020330000201500005253445340D9BC190EF639418AD0D3CAAC757DA701000000443A5C576F726B696E675C4769745265706F7369746F72795C4F7475735C6F7475732D6D7373716C2D323032302D30362D706F6C796174796B696E615C48573133202D2073702C66756E635C43535C526567756C617245787072657373696F6E735C537472696E6745787072657373696F6E735C6F626A5C44656275675C537472696E6745787072657373696F6E732E70646200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006434000000000000000000007E34000000200000000000000000000000000000000000000000000070340000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF250020001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001001000000018000080000000000000000000000000000001000100000030000080000000000000000000000000000001000000000048000000584000006C02000000000000000000006C0234000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000000000000000000000000000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004CC010000010053007400720069006E006700460069006C00650049006E0066006F000000A801000001003000300030003000300034006200300000002C0002000100460069006C0065004400650073006300720069007000740069006F006E000000000020000000300008000100460069006C006500560065007200730069006F006E000000000030002E0030002E0030002E00300000004C001600010049006E007400650072006E0061006C004E0061006D006500000053007400720069006E006700450078007000720065007300730069006F006E0073002E0064006C006C0000002800020001004C006500670061006C0043006F0070007900720069006700680074000000200000005400160001004F0072006900670069006E0061006C00460069006C0065006E0061006D006500000053007400720069006E006700450078007000720065007300730069006F006E0073002E0064006C006C000000340008000100500072006F006400750063007400560065007200730069006F006E00000030002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000030002E0030002E0030002E003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000C000000903400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000;

GO 

PRINT N'Creating [dbo].[StringAgg]...'; 

GO
CREATE AGGREGATE [dbo].[StringAgg](@value NVARCHAR (MAX) NULL, @delimeter NVARCHAR (MAX) NULL, @unique BIT NULL)
    RETURNS NVARCHAR (MAX)
    EXTERNAL NAME [StringExpressions].[StringExpressions.StringAgg];

PRINT N'Creating [dbo].[StringSplit]...';
 
GO
CREATE FUNCTION [dbo].[StringSplit]
(@value NVARCHAR (MAX) NULL, @delimeters NVARCHAR (MAX) NULL)
RETURNS 
     TABLE (
        [Index] INT            NULL,
        [Text]  NVARCHAR (MAX) NULL)
AS
 EXTERNAL NAME [StringExpressions].[StringExpressions.SqlStringEx].[StringSplit]


GO
PRINT N'Update complete.';


GO